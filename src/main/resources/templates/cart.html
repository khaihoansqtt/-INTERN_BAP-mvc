<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List User</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div style="color: red; text-align: center;font-size: 44px;">CART</div>
        <div style="font-size: 22px; font-weight: 600;">Tên khách hàng: <span th:text="${user.userName}"></span></div>
        <table class="table table-dark table-striped">
            <thead>
                <tr>
                    <th scope="col">CartItem ID</th>
                    <th scope="col">Tên sản phẩm</th>
                    <th scope="col">Số lượng</th>
                    <th scope="col">Giá</th>
                    <th scope="col">Hành động</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="cartItem : ${cartItems}">
                    <th scope="row" th:text="${cartItem.cartItemId}"></th>
                    <td th:text="${cartItem.product.productName}"></td>
                    <td th:text="${cartItem.quantity}"></td>
                    <td th:text="${cartItem.product.price}"></td>
                    <td>
                        <form action="/cart/delete" method="post">
                            <input type="hidden" name="userId" th:value="${user.userId}">
                            <input type="hidden" name="cartItemId" th:value="${cartItem.cartItemId}">
                            <button type="submit" class="btn btn-primary">Delete</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
        <form action="/order" method="post">
            <input type="hidden" name="userId" th:value="${user.userId}">
            <button class="btn btn-lg btn-primary" type="submit">Thanh toán giỏ hàng</button>
        </form>

        <div style="color: red; text-align: center;font-size: 44px; margin-top:40px;">DANH SÁCH SẢN PHẨM MUỐN ADD VÀO CART</div>
        <table class="table table-dark table-striped">
            <thead>
                <tr>
                    <th scope="col">Product ID</th>
                    <th scope="col">Tên sản phẩm</th>
                    <th scope="col">Giá</th>
                    <th scope="col">Số lượng</th>
                    <th scope="col">Hành động</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="product : ${products}">
                    <th scope="row" th:text="${product.productId}"></th>
                    <td th:text="${product.productName}"></td>
                    <td th:text="${product.price}"></td>
                    <td><input th:class="'quantityA quantity-' + ${product.productId}" type="number" name="quantity"
                            value="1" /></td>
                    <td>
                        <form action="/cart/add" method="post">
                            <input type="hidden" name="userId" th:value="${user.userId}">
                            <input type="hidden" name="productId" th:value="${product.productId}">
                            <input th:class="'quantityB quantity-' + ${product.productId}" type="hidden" name="quantity"
                                value="1">
                            <button type="submit" class="btn btn-primary">Thêm vào giỏ hàng</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>

    </div>
    <script>
        const quantityA = document.querySelectorAll(".quantityA");
        quantityA.forEach((item, index) => {
            item.onchange = (e) => {
                const quantityBClass = e.target.classList[1]
                console.log(quantityBClass)

                const quantityB = document.querySelector(`.quantityB.${quantityBClass}`);
                quantityB.value = e.target.value
                console.log(quantityB.value)
            }
        })
    </script>
</body>
</html>